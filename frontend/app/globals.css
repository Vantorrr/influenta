@tailwind base;
@tailwind components;
@tailwind utilities;

/* CSS переменные для темы Telegram */
:root {
  --color-telegram-primary: #2AABEE;
  --color-telegram-secondary: #229ED9;
  --color-telegram-bg: #17212B;
  --color-telegram-bgSecondary: #232E3C;
  --color-telegram-text: #FFFFFF;
  --color-telegram-textSecondary: #8B9AAB;
  --color-telegram-accent: #71AAEB;
  --color-telegram-success: #4DCD5E;
  --color-telegram-danger: #FF3B30;
  --color-telegram-warning: #FFA000;
}

@layer base {
  * {
    box-sizing: border-box;
  }

  html {
    height: 100%;
    height: 100vh;
    height: 100dvh; /* Dynamic viewport height for mobile */
  }

  body {
    height: 100%;
    height: 100vh;
    height: 100dvh; /* Dynamic viewport height for mobile */
    height: var(--tg-viewport-height, 100vh); /* Telegram viewport */
    background-color: var(--color-telegram-bg);
    color: var(--color-telegram-text);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    overflow: hidden !important;
    position: fixed !important;
    width: 100% !important;
    top: 0 !important;
    left: 0 !important;
    /* Отключаем bounce scroll на iOS */
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: none;
    /* Убираем margins/padding */
    margin: 0 !important;
    padding: 0 !important;
  }

  /* Контейнер приложения */
  #__next {
    height: 100% !important;
    height: 100vh !important;
    height: 100dvh !important;
    height: var(--tg-viewport-height, 100vh) !important;
    overflow: hidden !important;
    position: relative !important;
  }

  /* Полноэкранный режим для Telegram Mini App */
  .telegram-viewport {
    height: var(--tg-viewport-height, 100vh);
    height: var(--tg-viewport-height, 100dvh);
    overflow: hidden;
  }

  /* Отключаем zoom на iOS */
  input, textarea, select {
    font-size: 16px !important;
  }

  /* Убираем highlight при тапе на iOS */
  * {
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
  }

  /* Scrollbar styles */
  ::-webkit-scrollbar {
    width: 0.5rem;
  }

  ::-webkit-scrollbar-track {
    background-color: var(--color-telegram-bgSecondary);
  }

  ::-webkit-scrollbar-thumb {
    background-color: var(--color-telegram-textSecondary);
    border-radius: 9999px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background-color: var(--color-telegram-accent);
  }
}

@layer components {
  .container {
    max-width: 80rem;
    margin-left: auto;
    margin-right: auto;
    padding-left: 1rem;
    padding-right: 1rem;
  }
  @media (min-width: 640px) {
    .container { padding-left: 1.5rem; padding-right: 1.5rem; }
  }
  @media (min-width: 1024px) {
    .container { padding-left: 2rem; padding-right: 2rem; }
  }

  .btn {
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    font-weight: 500;
    transition: all 200ms;
  }
  .btn:active { transform: scale(0.95); }

  .btn-primary {
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    font-weight: 500;
    transition: all 200ms;
    color: white;
    background-color: var(--color-telegram-primary);
  }
  .btn-primary:hover { background-color: var(--color-telegram-secondary); }
  .btn-primary:active { transform: scale(0.95); }

  .btn-secondary {
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    font-weight: 500;
    transition: all 200ms;
    background-color: var(--color-telegram-bgSecondary);
    color: var(--color-telegram-text);
  }
  .btn-secondary:active { transform: scale(0.95); }

  .card {
    border-radius: 0.75rem;
    padding: 1rem;
    border: 1px solid rgb(55 65 81 / 0.5);
    background-color: var(--color-telegram-bgSecondary);
  }

  .input {
    width: 100%;
    padding: 0.5rem 1rem;
    border: 1px solid rgb(75 85 99);
    border-radius: 0.5rem;
    transition: border-color 150ms;
    background-color: var(--color-telegram-bg);
    color: var(--color-telegram-text);
  }
  .input:focus { outline: none; }
  .input::placeholder { color: var(--color-telegram-textSecondary); }
  .input:focus { border-color: var(--color-telegram-primary); }

  .label {
    font-size: 0.875rem;
    font-weight: 500;
    margin-bottom: 0.25rem;
    display: block;
    color: var(--color-telegram-textSecondary);
  }
}

@layer utilities {
  .animate-in {
    animation: fadeIn 0.3s ease-in-out;
  }
  
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  @keyframes float {
    0%, 100% {
      transform: translateY(0px);
    }
    50% {
      transform: translateY(-20px);
    }
  }
  
  @keyframes pulse-glow {
    0%, 100% {
      box-shadow: 0 0 20px rgba(42, 171, 238, 0.5);
    }
    50% {
      box-shadow: 0 0 40px rgba(42, 171, 238, 0.8);
    }
  }

  .glass {
    backdrop-filter: blur(12px);
    background-color: rgb(255 255 255 / 0.05);
  }

  .text-gradient {
    background-clip: text;
    -webkit-background-clip: text;
    color: transparent;
    background-image: linear-gradient(to right, var(--color-telegram-primary), var(--color-telegram-accent));
  }
  
  .preserve-3d {
    transform-style: preserve-3d;
  }
  
  .perspective-1000 {
    perspective: 1000px;
  }
  
  .backface-hidden {
    backface-visibility: hidden;
  }
  
  /* Performance optimizations */
  .will-change-transform {
    will-change: transform;
  }
  
  .gpu-accelerated {
    transform: translateZ(0);
    will-change: transform;
  }
  
  /* Reduced motion for accessibility */
  @media (prefers-reduced-motion: reduce) {
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }
}

/* Fallback utility classes for color tokens (to avoid PostCSS unknown utility errors) */
.bg-telegram-bg { background-color: var(--color-telegram-bg) !important; }
.bg-telegram-bgSecondary { background-color: var(--color-telegram-bgSecondary) !important; }
.bg-telegram-primary { background-color: var(--color-telegram-primary) !important; }
.bg-telegram-secondary { background-color: var(--color-telegram-secondary) !important; }
.bg-telegram-accent { background-color: var(--color-telegram-accent) !important; }
.text-telegram-text { color: var(--color-telegram-text) !important; }
.text-telegram-textSecondary { color: var(--color-telegram-textSecondary) !important; }
.border-telegram-primary { border-color: var(--color-telegram-primary) !important; }